webpackJsonp([3],{105:function(e,t,r){"use strict";t.default={name:"sg-body",props:{col:{type:Number,default:20}}}},106:function(e,t,r){t=e.exports=r(8)(),t.push([e.i,".sg-body{margin-top:10px}",""])},107:function(e,t,r){var a,o;r(109),a=r(105);var n=r(108);o=a=a||{},"object"!=typeof a.default&&"function"!=typeof a.default||(o=a=a.default),"function"==typeof o&&(o=o.options),o.render=n.render,o.staticRenderFns=n.staticRenderFns,e.exports=a},108:function(e,t){e.exports={render:function(){var e=this;return e._h("el-row",{staticClass:"sg-body",attrs:{type:"flex",justify:"center"}},[e._h("el-col",{attrs:{span:e.col}},[e._t("default")])])},staticRenderFns:[]}},109:function(e,t,r){var a=r(106);"string"==typeof a&&(a=[[e.i,a,""]]);r(9)(a,{});a.locals&&(e.exports=a.locals)},131:function(e,t,r){"use strict";var a=r(107),o=r.n(a),n=r(4),s=(r.n(n),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e});t.default={name:"newTopic",data:function(){return{area:this.$route.params.area,areas:[],captcha:this.$store.state.config.captcha,preview:!1,buttonLoading:!1,form:{title:"",content:"",captcha:"",areaId:void 0},rules:{areaId:[{type:"number",required:!0,message:"请选择区域",trigger:"change"}],title:[{required:!0,message:"请输入文章标题",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],content:[{required:!0,message:"请输入文章内容",trigger:"blur"},{min:1,message:"长度大于1",trigger:"blur"}]}}},computed:{previewButton:function(){return this.preview?"关闭预览":"实时预览"}},methods:s({},r.i(n.mapActions)(["post"]),{onSubmit:function(e){var t=this;this.$refs.form.validate(function(e){return e?void t.post({url:"/t/new",data:t.form}).then(function(e){e.result?(t.$router.push("/t/"+e.data.topic.url),t.$message({message:"恭喜你，主题已发布",type:"success"})):t.$message({message:e.message,type:"warning"})}):(t.$message({message:"请填写必要信息",type:"warning"}),!1)})},getData:function(){var e=this;this.post({url:"/base/area"}).then(function(t){t.result?e.areas=t.data.areaList:e.$message.error("请填写必要信息")})},changeAreaChoosed:function(){for(var e=0;e<this.areas.length;e++)if(this.areas[e].abbr==this.area)return void(this.form.areaId=this.areas[e].id);this.$message.error("不存在此区域或此区域无法无法发布主题,请选择其他区域")},shouldChange:function(){return this.area&&this.areas.length>0},showPreview:function(){this.preview=!this.preview,this.preview&&(this.buttonLoading=!0)},rendered:function(){this.buttonLoading=!1}}),watch:{area:function(e,t){this.shouldChange()&&this.changeAreaChoosed()},areas:function(e,t){this.shouldChange()&&this.changeAreaChoosed()}},created:function(){this.getData()},components:{"sg-body":o.a,"sg-markdown":function(e,t){r.e(9).catch(function(e){r.oe(e)}).then(function(){var t=[r(126)];e.apply(null,t)}.bind(this))}}}},142:function(e,t,r){t=e.exports=r(8)(),t.push([e.i,".publish{min-height:100px;padding:10px 0;border-radius:.2em;background-color:#fff;margin-bottom:1rem;box-shadow:0 2px 3px rgba(0,0,0,.1);border-bottom:1px solid hsla(0,0%,64%,.31)}.topicContent .el-textarea__inner{min-height:150px}",""])},30:function(e,t,r){var a,o;r(398),a=r(131);var n=r(389);o=a=a||{},"object"!=typeof a.default&&"function"!=typeof a.default||(o=a=a.default),"function"==typeof o&&(o=o.options),o.render=n.render,o.staticRenderFns=n.staticRenderFns,e.exports=a},389:function(e,t){e.exports={render:function(){var e=this;return e._h("sg-body",[e._t("default",[e._h("el-row",{attrs:{type:"flex",justify:"center"}},[e._h("el-col",{attrs:{span:15}},[e._h("el-form",{ref:"form",attrs:{rules:e.rules,"label-position":"left",model:e.form,"label-width":"100px"}},[e._h("el-form-item",{attrs:{label:"区域名称",prop:"areaId"}},[e._h("el-select",{directives:[{name:"model",rawName:"v-model",value:e.form.areaId,expression:"form.areaId"}],attrs:{placeholder:"请选择区域"},domProps:{value:e.form.areaId},on:{input:function(t){e.form.areaId=t}}},[e._l(e.areas,function(t){return e._h("el-option",{attrs:{label:t.name,value:t.id}})})])])," ",e._h("el-form-item",{attrs:{label:"标题",prop:"title"}},[e._h("el-input",{directives:[{name:"model",rawName:"v-model",value:e.form.title,expression:"form.title"}],domProps:{value:e.form.title},on:{input:function(t){e.form.title=t}}})])," ",e._h("el-form-item",{attrs:{label:"内容",prop:"content"}},[e._h("el-input",{directives:[{name:"model",rawName:"v-model",value:e.form.content,expression:"form.content"}],staticClass:"topicContent",attrs:{type:"textarea"},domProps:{value:e.form.content},on:{input:function(t){e.form.content=t}}})," ",e.preview?e._h("sg-markdown",{attrs:{sourceOut:e.form.content},on:{rendered:e.rendered}}):e._e()])," ",e.captcha?e._h("el-form-item",{attrs:{label:"验证码",prop:"captcha"}},[e._h("el-input",{directives:[{name:"model",rawName:"v-model",value:e.form.captcha,expression:"form.captcha"}],domProps:{value:e.form.captcha},on:{input:function(t){e.form.captcha=t}}})]):e._e()," ",e._h("el-form-item",[e._h("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},["立即创建"])," ",e._h("el-button",{attrs:{loading:e.buttonLoading},on:{click:e.showPreview}},[e._s(e.previewButton)])])])])," ",e._h("el-col",{attrs:{span:7,offset:1}},[e._h("el-row",{staticClass:"publish"},[e._h("el-row",{attrs:{col:24}},["\n                        主题发布公告\n                    "])])])])])])},staticRenderFns:[]}},398:function(e,t,r){var a=r(142);"string"==typeof a&&(a=[[e.i,a,""]]);r(9)(a,{});a.locals&&(e.exports=a.locals)}});
//# sourceMappingURL=3.js.map